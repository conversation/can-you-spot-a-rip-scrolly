import { useRef, useState } from 'react'
import { Stage, Layer, Line } from 'react-konva'
import useSize from '@react-hook/size'
import { KonvaEventObject } from 'konva/lib/Node'
import { useAtom, useAtomValue } from 'jotai'
import { quizReveal, standardSize } from '../../context/Atoms'

export default function QuizOne() {
  const parentRef = useRef(null)
  const [width, height] = useSize(parentRef)
  const [isDrawing, setIsDrawing] = useState(false)
  const [lines, setLines] = useState<{ points: number[]; stroke: string }[]>([])
  const originalSize = useAtomValue(standardSize)
  const [revealAnswer, setReveal] = useAtom(quizReveal)
  const answerLines: { points: number[]; stroke: string }[] = [
    {
      points: [
        413.4022590361446, 482.24357443820236, 413.4022590361446, 482.24357443820236, 413.4022590361446,
        482.24357443820236, 413.4022590361446, 482.24357443820236, 413.4022590361446, 482.24357443820236,
        412.40177710843375, 482.24357443820236, 412.40177710843375, 483.24325341091503, 411.4012951807229,
        483.24325341091503, 411.4012951807229, 483.24325341091503, 410.4008132530121, 483.24325341091503,
        410.4008132530121, 484.2429323836277, 409.40033132530124, 484.2429323836277, 409.40033132530124,
        484.2429323836277, 408.3998493975904, 485.2426113563404, 407.39936746987956, 485.2426113563404,
        406.39888554216867, 486.24229032905305, 405.39840361445783, 486.24229032905305, 404.397921686747,
        487.2419693017657, 403.39743975903616, 487.2419693017657, 402.3969578313253, 488.2416482744784,
        401.3964759036145, 488.2416482744784, 400.39599397590365, 489.2413272471911, 399.3955120481928,
        490.2410062199038, 397.3945481927711, 490.2410062199038, 396.39406626506025, 491.24068519261647,
        395.3935843373494, 492.24036416532914, 394.3931024096386, 492.24036416532914, 392.3921385542169,
        493.2400431380418, 391.39165662650606, 493.2400431380418, 389.3906927710844, 494.2397221107545,
        387.38972891566266, 494.2397221107545, 386.3892469879518, 495.23940108346716, 384.38828313253015,
        495.23940108346716, 383.3878012048193, 495.23940108346716, 381.38683734939764, 496.2390800561799,
        380.38635542168674, 496.2390800561799, 378.38539156626507, 496.2390800561799, 376.3844277108434,
        497.23875902889256, 373.3829819277109, 497.23875902889256, 371.38201807228916, 497.23875902889256,
        370.3815361445783, 497.23875902889256, 366.379608433735, 497.23875902889256, 363.3781626506024,
        498.23843800160523, 361.37719879518073, 498.23843800160523, 359.37623493975906, 498.23843800160523,
        356.37478915662655, 498.23843800160523, 354.3738253012048, 498.23843800160523, 352.37286144578314,
        498.23843800160523, 349.37141566265063, 499.2381169743179, 347.37045180722896, 499.2381169743179,
        344.3690060240964, 499.2381169743179, 342.3680421686747, 499.2381169743179, 340.36707831325305,
        499.2381169743179, 338.3661144578314, 499.2381169743179, 335.3646686746988, 499.2381169743179,
        333.36370481927713, 500.2377959470306, 331.36274096385546, 500.2377959470306, 328.3612951807229,
        500.2377959470306, 325.3598493975904, 500.2377959470306, 323.3588855421687, 500.2377959470306,
        320.35743975903614, 501.23747491974325, 317.35599397590363, 501.23747491974325, 315.35503012048196,
        501.23747491974325, 313.3540662650603, 501.23747491974325, 309.3521385542169, 502.2371538924559,
        306.35069277108437, 502.2371538924559, 304.3497289156627, 502.2371538924559, 301.3482831325301,
        502.2371538924559, 299.34731927710845, 502.2371538924559, 297.3463554216868, 502.2371538924559,
        295.34539156626505, 503.23683286516865, 292.34394578313254, 503.23683286516865, 290.34298192771087,
        503.23683286516865, 288.3420180722892, 503.23683286516865, 286.34105421686746, 503.23683286516865,
        284.3400903614458, 503.23683286516865, 281.3386445783133, 503.23683286516865, 278.3371987951807,
        504.2365118378813, 276.33623493975904, 504.2365118378813, 274.33527108433736, 504.2365118378813,
        272.3343072289157, 504.2365118378813, 270.333343373494, 504.2365118378813, 268.3323795180723, 504.2365118378813,
        266.3314156626506, 504.2365118378813, 264.33045180722894, 504.2365118378813, 262.32948795180727,
        504.2365118378813, 260.32852409638554, 504.2365118378813, 258.32756024096386, 504.2365118378813,
        256.3265963855422, 504.2365118378813, 254.3256325301205, 504.2365118378813, 252.3246686746988,
        504.2365118378813, 250.3237048192771, 504.2365118378813, 248.32274096385544, 504.2365118378813,
        246.32177710843374, 505.236190810594, 243.32033132530123, 505.236190810594, 241.31936746987952,
        505.236190810594, 240.3188855421687, 505.236190810594, 238.317921686747, 505.236190810594, 236.3169578313253,
        505.236190810594, 234.31599397590364, 505.236190810594, 231.3145481927711, 505.236190810594, 229.31358433734943,
        505.236190810594, 226.3121385542169, 505.236190810594, 224.31117469879518, 505.236190810594, 221.30972891566267,
        505.236190810594, 220.3092469879518, 505.236190810594, 218.30828313253014, 505.236190810594, 217.3078012048193,
        505.236190810594, 216.30731927710843, 505.236190810594, 215.3068373493976, 505.236190810594, 214.30635542168676,
        505.236190810594, 213.30587349397592, 505.236190810594, 213.30587349397592, 505.236190810594,
        213.30587349397592, 505.236190810594, 212.3053915662651, 505.236190810594, 211.30490963855422, 505.236190810594,
        211.30490963855422, 505.236190810594, 211.30490963855422, 505.236190810594, 211.30490963855422, 505.236190810594
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        417.404186746988, 512.2339436195828, 416.40370481927715, 512.2339436195828, 414.4027409638554,
        512.2339436195828, 413.4022590361446, 512.2339436195828, 412.40177710843375, 512.2339436195828,
        410.4008132530121, 512.2339436195828, 408.3998493975904, 512.2339436195828, 406.39888554216867,
        512.2339436195828, 405.39840361445783, 513.2336225922954, 402.3969578313253, 513.2336225922954,
        401.3964759036145, 513.2336225922954, 399.3955120481928, 513.2336225922954, 397.3945481927711,
        513.2336225922954, 396.39406626506025, 513.2336225922954, 395.3935843373494, 513.2336225922954,
        393.39262048192774, 513.2336225922954, 392.3921385542169, 513.2336225922954, 391.39165662650606,
        513.2336225922954, 390.3911746987952, 513.2336225922954, 387.38972891566266, 513.2336225922954,
        385.388765060241, 513.2336225922954, 382.3873192771085, 513.2336225922954, 379.3858734939759, 513.2336225922954,
        378.38539156626507, 513.2336225922954, 376.3844277108434, 513.2336225922954, 374.3834638554217,
        513.2336225922954, 371.38201807228916, 513.2336225922954, 369.3810542168675, 513.2336225922954,
        367.3800903614458, 513.2336225922954, 365.37912650602414, 513.2336225922954, 364.3786445783133,
        513.2336225922954, 362.37768072289157, 513.2336225922954, 360.3767168674699, 513.2336225922954,
        358.3757530120482, 513.2336225922954, 357.3752710843374, 513.2336225922954, 355.3743072289157,
        513.2336225922954, 353.373343373494, 513.2336225922954, 351.3723795180723, 513.2336225922954,
        349.37141566265063, 513.2336225922954, 347.37045180722896, 513.2336225922954, 345.36948795180723,
        513.2336225922954, 342.3680421686747, 513.2336225922954, 340.36707831325305, 513.2336225922954,
        337.3656325301205, 513.2336225922954, 334.36418674698797, 513.2336225922954, 331.36274096385546,
        513.2336225922954, 328.3612951807229, 513.2336225922954, 326.3603313253012, 513.2336225922954,
        324.35936746987954, 513.2336225922954, 321.35792168674703, 513.2336225922954, 319.3569578313253,
        513.2336225922954, 317.35599397590363, 513.2336225922954, 315.35503012048196, 513.2336225922954,
        313.3540662650603, 513.2336225922954, 311.35310240963855, 513.2336225922954, 309.3521385542169,
        513.2336225922954, 307.3511746987952, 514.2333015650081, 305.35021084337353, 514.2333015650081,
        304.3497289156627, 514.2333015650081, 302.34876506024096, 514.2333015650081, 301.3482831325301,
        514.2333015650081, 300.3478012048193, 514.2333015650081, 299.34731927710845, 514.2333015650081,
        297.3463554216868, 514.2333015650081, 296.34587349397594, 515.2329805377208, 294.3449096385542,
        515.2329805377208, 293.3444277108434, 515.2329805377208, 291.3434638554217, 515.2329805377208,
        290.34298192771087, 515.2329805377208, 288.3420180722892, 515.2329805377208, 286.34105421686746,
        515.2329805377208, 285.3405722891566, 516.2326595104335, 283.33960843373495, 516.2326595104335,
        281.3386445783133, 516.2326595104335, 279.3376807228916, 516.2326595104335, 277.3367168674699,
        516.2326595104335, 274.33527108433736, 516.2326595104335, 272.3343072289157, 517.2323384831461,
        270.333343373494, 517.2323384831461, 268.3323795180723, 517.2323384831461, 265.3309337349398, 517.2323384831461,
        263.3299698795181, 517.2323384831461, 261.32900602409643, 517.2323384831461, 258.32756024096386,
        517.2323384831461, 257.327078313253, 518.2320174558588, 256.3265963855422, 518.2320174558588, 254.3256325301205,
        518.2320174558588, 252.3246686746988, 518.2320174558588, 250.3237048192771, 518.2320174558588,
        247.3222590361446, 519.2316964285715, 245.3212951807229, 519.2316964285715, 243.32033132530123,
        519.2316964285715, 241.31936746987952, 519.2316964285715, 240.3188855421687, 519.2316964285715,
        238.317921686747, 519.2316964285715, 236.3169578313253, 519.2316964285715, 234.31599397590364,
        519.2316964285715, 233.31551204819277, 519.2316964285715, 231.3145481927711, 519.2316964285715,
        230.31406626506026, 520.2313754012843, 229.31358433734943, 520.2313754012843, 228.31310240963856,
        520.2313754012843, 227.31262048192772, 520.2313754012843, 227.31262048192772, 520.2313754012843,
        227.31262048192772, 520.2313754012843, 226.3121385542169, 520.2313754012843, 225.31165662650605,
        520.2313754012843, 225.31165662650605, 521.2310543739969, 224.31117469879518, 521.2310543739969,
        223.31069277108435, 521.2310543739969, 222.3102108433735, 521.2310543739969, 221.30972891566267,
        521.2310543739969
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        400.39599397590365, 315.29718599518463, 400.39599397590365, 315.29718599518463, 400.39599397590365,
        315.29718599518463, 400.39599397590365, 316.2968649678973, 400.39599397590365, 316.2968649678973,
        400.39599397590365, 317.29654394061004, 400.39599397590365, 318.2962229133227, 400.39599397590365,
        319.2959018860354, 400.39599397590365, 320.29558085874805, 400.39599397590365, 321.2952598314607,
        400.39599397590365, 322.2949388041734, 400.39599397590365, 323.29461777688607, 400.39599397590365,
        324.2942967495988, 400.39599397590365, 325.2939757223115, 400.39599397590365, 326.29365469502414,
        400.39599397590365, 327.2933336677368, 400.39599397590365, 327.2933336677368, 400.39599397590365,
        328.2930126404495, 400.39599397590365, 329.29269161316216, 400.39599397590365, 330.29237058587483,
        400.39599397590365, 331.29204955858756, 399.3955120481928, 332.29172853130024, 399.3955120481928,
        333.2914075040129, 399.3955120481928, 334.2910864767256, 399.3955120481928, 335.29076544943825,
        398.395030120482, 337.2901233948636, 398.395030120482, 338.2898023675763, 398.395030120482, 338.2898023675763,
        397.3945481927711, 340.2891603130017, 397.3945481927711, 341.28883928571435, 396.39406626506025,
        342.288518258427, 396.39406626506025, 343.2881972311397, 396.39406626506025, 343.2881972311397,
        395.3935843373494, 344.28787620385236, 395.3935843373494, 345.2875551765651, 394.3931024096386,
        345.2875551765651, 394.3931024096386, 346.28723414927777, 393.39262048192774, 347.28691312199044,
        393.39262048192774, 347.28691312199044, 392.3921385542169, 348.2865920947031, 391.39165662650606,
        349.2862710674158, 390.3911746987952, 350.28595004012845, 389.3906927710844, 351.2856290128411,
        388.3902108433735, 353.28498695826653, 387.38972891566266, 353.28498695826653, 386.3892469879518,
        354.2846659309792, 385.388765060241, 355.2843449036919, 384.38828313253015, 356.28402387640455,
        383.3878012048193, 357.2837028491172, 382.3873192771085, 358.28338182182995, 380.38635542168674,
        359.2830607945426, 379.3858734939759, 359.2830607945426, 377.38490963855423, 360.2827397672553,
        375.38394578313256, 361.28241873996797, 374.3834638554217, 362.28209771268064, 372.38250000000005,
        362.28209771268064, 370.3815361445783, 363.2817766853933, 368.38057228915665, 364.281455658106,
        366.379608433735, 364.281455658106, 365.37912650602414, 365.2811346308187, 363.3781626506024, 366.2808136035314,
        360.3767168674699, 366.2808136035314, 358.3757530120482, 366.2808136035314, 356.37478915662655,
        367.28049257624406, 353.373343373494, 367.28049257624406, 351.3723795180723, 368.28017154895673,
        349.37141566265063, 368.28017154895673, 347.37045180722896, 369.2798505216694, 345.36948795180723,
        369.2798505216694, 344.3690060240964, 369.2798505216694, 342.3680421686747, 369.2798505216694,
        340.36707831325305, 369.2798505216694, 340.36707831325305, 369.2798505216694, 337.3656325301205,
        369.2798505216694, 336.36515060240964, 369.2798505216694, 334.36418674698797, 369.2798505216694,
        332.3632228915663, 370.2795294943821, 329.3617771084337, 370.2795294943821, 327.36081325301205,
        370.2795294943821, 324.35936746987954, 370.2795294943821, 322.35840361445787, 370.2795294943821,
        319.3569578313253, 370.2795294943821, 317.35599397590363, 370.2795294943821, 315.35503012048196,
        370.2795294943821, 313.3540662650603, 370.2795294943821, 311.35310240963855, 370.2795294943821,
        309.3521385542169, 370.2795294943821, 307.3511746987952, 370.2795294943821, 305.35021084337353,
        370.2795294943821, 304.3497289156627, 370.2795294943821, 302.34876506024096, 370.2795294943821,
        300.3478012048193, 370.2795294943821, 298.3468373493976, 370.2795294943821, 296.34587349397594,
        370.2795294943821, 294.3449096385542, 370.2795294943821, 292.34394578313254, 370.2795294943821,
        290.34298192771087, 370.2795294943821, 289.34250000000003, 370.2795294943821, 287.34153614457836,
        370.2795294943821, 285.3405722891566, 370.2795294943821, 283.33960843373495, 370.2795294943821,
        282.3391265060241, 369.2798505216694, 279.3376807228916, 369.2798505216694, 276.33623493975904,
        369.2798505216694, 274.33527108433736, 369.2798505216694, 272.3343072289157, 369.2798505216694,
        271.33382530120485, 369.2798505216694, 269.3328614457831, 369.2798505216694, 268.3323795180723,
        369.2798505216694, 268.3323795180723, 369.2798505216694, 264.33045180722894, 369.2798505216694,
        263.3299698795181, 369.2798505216694, 262.32948795180727, 369.2798505216694, 260.32852409638554,
        369.2798505216694, 259.3280421686747, 369.2798505216694, 256.3265963855422, 369.2798505216694,
        254.3256325301205, 369.2798505216694, 253.32515060240965, 369.2798505216694, 251.32418674698798,
        369.2798505216694, 248.32274096385544, 368.28017154895673, 246.32177710843374, 368.28017154895673,
        245.3212951807229, 368.28017154895673, 243.32033132530123, 368.28017154895673, 242.3198493975904,
        368.28017154895673, 240.3188855421687, 368.28017154895673, 239.31840361445785, 368.28017154895673,
        237.31743975903615, 368.28017154895673, 235.31647590361447, 368.28017154895673, 233.31551204819277,
        368.28017154895673, 231.3145481927711, 367.28049257624406, 229.31358433734943, 367.28049257624406,
        226.3121385542169, 367.28049257624406, 223.31069277108435, 367.28049257624406, 220.3092469879518,
        366.2808136035314, 217.3078012048193, 366.2808136035314, 214.30635542168676, 366.2808136035314,
        211.30490963855422, 366.2808136035314, 210.30442771084338, 366.2808136035314, 209.30394578313255,
        366.2808136035314, 208.3034638554217, 366.2808136035314, 207.30298192771085, 366.2808136035314,
        207.30298192771085, 366.2808136035314, 207.30298192771085, 366.2808136035314, 207.30298192771085,
        366.2808136035314, 207.30298192771085, 366.2808136035314, 207.30298192771085, 366.2808136035314,
        207.30298192771085, 366.2808136035314
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        424.4075602409639, 389.273429975923, 424.4075602409639, 389.273429975923, 424.4075602409639, 389.273429975923,
        424.4075602409639, 389.273429975923, 423.407078313253, 389.273429975923, 423.407078313253, 389.273429975923,
        422.4065963855422, 389.273429975923, 420.4056325301205, 389.273429975923, 419.40515060240966, 389.273429975923,
        418.4046686746988, 388.27375100321035, 416.40370481927715, 388.27375100321035, 415.4032228915663,
        387.2740720304977, 414.4027409638554, 387.2740720304977, 413.4022590361446, 387.2740720304977,
        412.40177710843375, 387.2740720304977, 411.4012951807229, 386.274393057785, 410.4008132530121, 386.274393057785,
        409.40033132530124, 386.274393057785, 408.3998493975904, 386.274393057785, 407.39936746987956, 386.274393057785,
        405.39840361445783, 385.2747140850723, 403.39743975903616, 385.2747140850723, 402.3969578313253,
        385.2747140850723, 400.39599397590365, 385.2747140850723, 399.3955120481928, 385.2747140850723,
        399.3955120481928, 385.2747140850723, 398.395030120482, 385.2747140850723, 396.39406626506025,
        385.2747140850723, 395.3935843373494, 385.2747140850723, 395.3935843373494, 385.2747140850723,
        394.3931024096386, 385.2747140850723, 391.39165662650606, 386.274393057785, 390.3911746987952, 386.274393057785,
        387.38972891566266, 386.274393057785, 386.3892469879518, 386.274393057785, 385.388765060241, 386.274393057785,
        384.38828313253015, 386.274393057785, 383.3878012048193, 387.2740720304977, 382.3873192771085,
        387.2740720304977, 381.38683734939764, 387.2740720304977, 379.3858734939759, 388.27375100321035,
        378.38539156626507, 388.27375100321035, 376.3844277108434, 388.27375100321035, 374.3834638554217,
        389.273429975923, 373.3829819277109, 389.273429975923, 372.38250000000005, 389.273429975923, 370.3815361445783,
        390.2731089486357, 369.3810542168675, 390.2731089486357, 368.38057228915665, 390.2731089486357,
        365.37912650602414, 391.27278792134837, 363.3781626506024, 392.27246689406104, 361.37719879518073,
        392.27246689406104, 359.37623493975906, 392.27246689406104, 358.3757530120482, 393.27214586677377,
        356.37478915662655, 393.27214586677377, 354.3738253012048, 393.27214586677377, 353.373343373494,
        394.27182483948644, 351.3723795180723, 394.27182483948644, 350.37189759036147, 394.27182483948644,
        349.37141566265063, 394.27182483948644, 347.37045180722896, 395.2715038121991, 346.36996987951807,
        395.2715038121991, 344.3690060240964, 396.2711827849118, 342.3680421686747, 396.2711827849118,
        341.3675602409639, 396.2711827849118, 340.36707831325305, 397.27086175762446, 338.3661144578314,
        397.27086175762446, 338.3661144578314, 397.27086175762446, 335.3646686746988, 398.27054073033713,
        333.36370481927713, 398.27054073033713, 331.36274096385546, 398.27054073033713, 330.3622590361446,
        399.2702197030498, 328.3612951807229, 399.2702197030498, 325.3598493975904, 399.2702197030498,
        324.35936746987954, 399.2702197030498, 322.35840361445787, 400.26989867576253, 321.35792168674703,
        400.26989867576253, 319.3569578313253, 400.26989867576253, 317.35599397590363, 400.26989867576253,
        315.35503012048196, 401.2695776484752, 314.3545481927711, 401.2695776484752, 312.3535843373494,
        401.2695776484752, 311.35310240963855, 401.2695776484752, 309.3521385542169, 401.2695776484752,
        307.3511746987952, 401.2695776484752, 307.3511746987952, 401.2695776484752, 303.3492469879518,
        401.2695776484752, 302.34876506024096, 401.2695776484752, 300.3478012048193, 401.2695776484752,
        298.3468373493976, 401.2695776484752, 296.34587349397594, 402.2692566211879, 294.3449096385542,
        402.2692566211879, 293.3444277108434, 402.2692566211879, 292.34394578313254, 402.2692566211879,
        291.3434638554217, 401.2695776484752, 289.34250000000003, 401.2695776484752, 288.3420180722892,
        401.2695776484752, 287.34153614457836, 401.2695776484752, 286.34105421686746, 401.2695776484752,
        284.3400903614458, 401.2695776484752, 282.3391265060241, 401.2695776484752, 280.33816265060244,
        401.2695776484752, 279.3376807228916, 401.2695776484752, 278.3371987951807, 401.2695776484752,
        277.3367168674699, 400.26989867576253, 273.3347891566265, 400.26989867576253, 271.33382530120485,
        400.26989867576253, 270.333343373494, 400.26989867576253, 268.3323795180723, 399.2702197030498,
        268.3323795180723, 399.2702197030498, 267.33189759036145, 399.2702197030498, 265.3309337349398,
        399.2702197030498, 264.33045180722894, 399.2702197030498, 262.32948795180727, 399.2702197030498,
        261.32900602409643, 399.2702197030498, 259.3280421686747, 398.27054073033713, 257.327078313253,
        398.27054073033713, 254.3256325301205, 398.27054073033713, 251.32418674698798, 397.27086175762446,
        249.32322289156627, 397.27086175762446, 246.32177710843374, 397.27086175762446, 244.32081325301206,
        396.2711827849118, 242.3198493975904, 396.2711827849118, 241.31936746987952, 396.2711827849118,
        240.3188855421687, 396.2711827849118, 239.31840361445785, 396.2711827849118, 237.31743975903615,
        395.2715038121991, 235.31647590361447, 395.2715038121991, 234.31599397590364, 395.2715038121991,
        232.31503012048194, 394.27182483948644, 231.3145481927711, 394.27182483948644, 228.31310240963856,
        394.27182483948644, 226.3121385542169, 393.27214586677377, 224.31117469879518, 393.27214586677377,
        222.3102108433735, 392.27246689406104, 219.30876506024097, 392.27246689406104, 217.3078012048193,
        392.27246689406104, 216.30731927710843, 391.27278792134837, 214.30635542168676, 391.27278792134837,
        213.30587349397592, 391.27278792134837, 212.3053915662651, 390.2731089486357, 210.30442771084338,
        390.2731089486357, 209.30394578313255, 390.2731089486357, 208.3034638554217, 390.2731089486357, 206.3025,
        390.2731089486357, 204.30153614457834, 389.273429975923, 202.30057228915663, 389.273429975923,
        201.3000903614458, 389.273429975923, 200.29960843373496, 389.273429975923, 199.2991265060241, 389.273429975923,
        198.29864457831326, 389.273429975923, 197.29816265060242, 388.27375100321035, 196.29768072289158,
        388.27375100321035, 195.29719879518075, 388.27375100321035, 195.29719879518075, 388.27375100321035,
        195.29719879518075, 388.27375100321035, 195.29719879518075, 388.27375100321035, 194.29671686746988,
        388.27375100321035, 194.29671686746988, 388.27375100321035, 194.29671686746988, 388.27375100321035,
        194.29671686746988, 388.27375100321035
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        404.397921686747, 264.31355838683794, 404.397921686747, 265.3132373595506, 403.39743975903616,
        265.3132373595506, 402.3969578313253, 265.3132373595506, 400.39599397590365, 265.3132373595506,
        399.3955120481928, 265.3132373595506, 397.3945481927711, 265.3132373595506, 395.3935843373494,
        265.3132373595506, 392.3921385542169, 265.3132373595506, 389.3906927710844, 265.3132373595506,
        387.38972891566266, 265.3132373595506, 384.38828313253015, 265.3132373595506, 382.3873192771085,
        265.3132373595506, 379.3858734939759, 265.3132373595506, 377.38490963855423, 265.3132373595506,
        375.38394578313256, 266.3129163322633, 373.3829819277109, 266.3129163322633, 370.3815361445783,
        266.3129163322633, 368.38057228915665, 266.3129163322633, 366.379608433735, 266.3129163322633,
        364.3786445783133, 266.3129163322633, 361.37719879518073, 266.3129163322633, 359.37623493975906,
        266.3129163322633, 355.3743072289157, 266.3129163322633, 353.373343373494, 266.3129163322633,
        352.37286144578314, 266.3129163322633, 350.37189759036147, 266.3129163322633, 348.3709337349398,
        266.3129163322633, 346.36996987951807, 266.3129163322633, 345.36948795180723, 266.3129163322633,
        343.36852409638556, 266.3129163322633, 342.3680421686747, 266.3129163322633, 340.36707831325305,
        266.3129163322633, 338.3661144578314, 266.3129163322633, 336.36515060240964, 265.3132373595506,
        333.36370481927713, 265.3132373595506, 331.36274096385546, 265.3132373595506, 329.3617771084337,
        265.3132373595506, 327.36081325301205, 265.3132373595506, 325.3598493975904, 265.3132373595506,
        322.35840361445787, 265.3132373595506, 320.35743975903614, 265.3132373595506, 318.35647590361447,
        265.3132373595506, 317.35599397590363, 265.3132373595506, 314.3545481927711, 265.3132373595506,
        312.3535843373494, 265.3132373595506, 310.3526204819277, 265.3132373595506, 307.3511746987952,
        265.3132373595506, 305.35021084337353, 265.3132373595506, 303.3492469879518, 264.31355838683794,
        300.3478012048193, 264.31355838683794, 298.3468373493976, 264.31355838683794, 296.34587349397594,
        264.31355838683794, 293.3444277108434, 264.31355838683794, 292.34394578313254, 264.31355838683794,
        290.34298192771087, 264.31355838683794, 288.3420180722892, 264.31355838683794, 287.34153614457836,
        264.31355838683794, 286.34105421686746, 264.31355838683794, 284.3400903614458, 264.31355838683794,
        282.3391265060241, 264.31355838683794, 280.33816265060244, 264.31355838683794, 279.3376807228916,
        265.3132373595506, 277.3367168674699, 265.3132373595506, 276.33623493975904, 265.3132373595506,
        274.33527108433736, 265.3132373595506, 272.3343072289157, 265.3132373595506, 270.333343373494,
        265.3132373595506, 268.3323795180723, 265.3132373595506, 266.3314156626506, 265.3132373595506,
        263.3299698795181, 265.3132373595506, 261.32900602409643, 265.3132373595506, 258.32756024096386,
        265.3132373595506, 255.32611445783135, 266.3129163322633, 252.3246686746988, 266.3129163322633,
        248.32274096385544, 266.3129163322633, 245.3212951807229, 266.3129163322633, 241.31936746987952,
        266.3129163322633, 238.317921686747, 267.31259530497596, 235.31647590361447, 267.31259530497596,
        232.31503012048194, 267.31259530497596, 230.31406626506026, 267.31259530497596, 229.31358433734943,
        267.31259530497596, 229.31358433734943, 267.31259530497596, 228.31310240963856, 267.31259530497596,
        227.31262048192772, 267.31259530497596, 226.3121385542169, 268.31227427768863, 225.31165662650605,
        268.31227427768863, 224.31117469879518, 268.31227427768863, 222.3102108433735, 268.31227427768863,
        220.3092469879518, 269.31195325040136, 218.30828313253014, 269.31195325040136, 217.3078012048193,
        269.31195325040136, 217.3078012048193, 269.31195325040136, 217.3078012048193, 269.31195325040136,
        216.30731927710843, 269.31195325040136, 216.30731927710843, 269.31195325040136, 216.30731927710843,
        269.31195325040136, 216.30731927710843, 269.31195325040136
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        401.3964759036145, 278.30906400481547, 400.39599397590365, 277.3093850321028, 400.39599397590365,
        277.3093850321028, 399.3955120481928, 277.3093850321028, 398.395030120482, 277.3093850321028,
        396.39406626506025, 278.30906400481547, 394.3931024096386, 278.30906400481547, 392.3921385542169,
        278.30906400481547, 389.3906927710844, 278.30906400481547, 385.388765060241, 278.30906400481547,
        381.38683734939764, 278.30906400481547, 379.3858734939759, 278.30906400481547, 377.38490963855423,
        279.30874297752814, 374.3834638554217, 279.30874297752814, 371.38201807228916, 279.30874297752814,
        369.3810542168675, 279.30874297752814, 367.3800903614458, 279.30874297752814, 365.37912650602414,
        279.30874297752814, 363.3781626506024, 279.30874297752814, 360.3767168674699, 280.3084219502408,
        357.3752710843374, 280.3084219502408, 354.3738253012048, 280.3084219502408, 353.373343373494, 280.3084219502408,
        351.3723795180723, 280.3084219502408, 349.37141566265063, 281.3081009229535, 347.37045180722896,
        281.3081009229535, 344.3690060240964, 281.3081009229535, 342.3680421686747, 281.3081009229535,
        341.3675602409639, 281.3081009229535, 340.36707831325305, 282.30777989566616, 338.3661144578314,
        282.30777989566616, 336.36515060240964, 283.3074588683789, 335.3646686746988, 283.3074588683789,
        333.36370481927713, 283.3074588683789, 332.3632228915663, 284.30713784109156, 332.3632228915663,
        284.30713784109156, 331.36274096385546, 284.30713784109156, 330.3622590361446, 285.30681681380423,
        328.3612951807229, 285.30681681380423, 328.3612951807229, 286.3064957865169, 327.36081325301205,
        286.3064957865169, 326.3603313253012, 287.3061747592296, 325.3598493975904, 287.3061747592296,
        324.35936746987954, 288.30585373194225, 322.35840361445787, 289.3055327046549, 322.35840361445787,
        289.3055327046549, 321.35792168674703, 289.3055327046549, 320.35743975903614, 290.30521167736765,
        319.3569578313253, 291.3048906500803, 318.35647590361447, 292.304569622793, 317.35599397590363,
        292.304569622793, 316.3555120481928, 293.30424859550567, 316.3555120481928, 293.30424859550567,
        314.3545481927711, 294.30392756821834, 312.3535843373494, 295.303606540931, 310.3526204819277, 295.303606540931,
        309.3521385542169, 296.3032855136437, 308.35165662650604, 297.3029644863564, 307.3511746987952,
        297.3029644863564, 305.35021084337353, 298.3026434590691, 304.3497289156627, 299.30232243178176,
        302.34876506024096, 300.30200140449443, 300.3478012048193, 300.30200140449443, 298.3468373493976,
        301.3016803772071, 296.34587349397594, 302.3013593499198, 294.3449096385542, 302.3013593499198,
        292.34394578313254, 303.30103832263245, 290.34298192771087, 304.3007172953452, 289.34250000000003,
        304.3007172953452, 288.3420180722892, 304.3007172953452, 287.34153614457836, 305.30039626805785,
        285.3405722891566, 305.30039626805785, 283.33960843373495, 305.30039626805785, 282.3391265060241,
        306.3000752407705, 281.3386445783133, 306.3000752407705, 279.3376807228916, 306.3000752407705,
        277.3367168674699, 306.3000752407705, 276.33623493975904, 306.3000752407705, 274.33527108433736,
        307.2997542134832, 271.33382530120485, 307.2997542134832, 269.3328614457831, 307.2997542134832,
        267.33189759036145, 307.2997542134832, 266.3314156626506, 307.2997542134832, 263.3299698795181,
        307.2997542134832, 261.32900602409643, 308.29943318619587, 258.32756024096386, 308.29943318619587,
        256.3265963855422, 308.29943318619587, 254.3256325301205, 308.29943318619587, 252.3246686746988,
        308.29943318619587, 249.32322289156627, 308.29943318619587, 247.3222590361446, 308.29943318619587,
        245.3212951807229, 308.29943318619587, 244.32081325301206, 308.29943318619587, 243.32033132530123,
        308.29943318619587, 242.3198493975904, 308.29943318619587, 240.3188855421687, 308.29943318619587,
        239.31840361445785, 308.29943318619587, 238.317921686747, 308.29943318619587, 236.3169578313253,
        308.29943318619587, 235.31647590361447, 308.29943318619587, 234.31599397590364, 308.29943318619587,
        233.31551204819277, 308.29943318619587, 232.31503012048194, 308.29943318619587, 232.31503012048194,
        308.29943318619587, 231.3145481927711, 308.29943318619587, 230.31406626506026, 308.29943318619587,
        229.31358433734943, 308.29943318619587, 228.31310240963856, 308.29943318619587, 228.31310240963856,
        308.29943318619587, 227.31262048192772, 308.29943318619587, 227.31262048192772, 308.29943318619587,
        227.31262048192772, 308.29943318619587, 227.31262048192772, 308.29943318619587, 227.31262048192772,
        308.29943318619587, 227.31262048192772, 308.29943318619587, 227.31262048192772, 308.29943318619587
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        340.36707831325305, 164.34566111556984, 339.3665963855422, 164.34566111556984, 339.3665963855422,
        164.34566111556984, 338.3661144578314, 165.34534008828254, 337.3656325301205, 164.34566111556984,
        336.36515060240964, 164.34566111556984, 335.3646686746988, 164.34566111556984, 334.36418674698797,
        164.34566111556984, 332.3632228915663, 165.34534008828254, 331.36274096385546, 165.34534008828254,
        329.3617771084337, 165.34534008828254, 327.36081325301205, 165.34534008828254, 326.3603313253012,
        165.34534008828254, 324.35936746987954, 165.34534008828254, 323.3588855421687, 165.34534008828254,
        321.35792168674703, 165.34534008828254, 318.35647590361447, 166.3450190609952, 316.3555120481928,
        166.3450190609952, 314.3545481927711, 166.3450190609952, 313.3540662650603, 166.3450190609952,
        311.35310240963855, 166.3450190609952, 309.3521385542169, 167.34469803370789, 307.3511746987952,
        167.34469803370789, 305.35021084337353, 167.34469803370789, 303.3492469879518, 167.34469803370789,
        301.3482831325301, 168.3443770064206, 300.3478012048193, 168.3443770064206, 298.3468373493976,
        168.3443770064206, 297.3463554216868, 169.34405597913326, 294.3449096385542, 169.34405597913326,
        293.3444277108434, 169.34405597913326, 291.3434638554217, 170.34373495184593, 289.34250000000003,
        170.34373495184593, 287.34153614457836, 170.34373495184593, 285.3405722891566, 171.34341392455863,
        285.3405722891566, 171.34341392455863, 280.33816265060244, 172.3430928972713, 279.3376807228916,
        172.3430928972713, 277.3367168674699, 172.3430928972713, 276.33623493975904, 172.3430928972713,
        274.33527108433736, 172.3430928972713, 272.3343072289157, 173.34277186998398, 271.33382530120485,
        173.34277186998398, 270.333343373494, 173.34277186998398, 269.3328614457831, 173.34277186998398,
        269.3328614457831, 173.34277186998398, 269.3328614457831, 173.34277186998398, 269.3328614457831,
        173.34277186998398, 269.3328614457831, 173.34277186998398, 269.3328614457831, 173.34277186998398,
        269.3328614457831, 173.34277186998398, 269.3328614457831, 173.34277186998398
      ],
      stroke: '#feaa01'
    },
    {
      points: [
        331.36274096385546, 157.34790830658108, 330.3622590361446, 157.34790830658108, 330.3622590361446,
        157.34790830658108, 330.3622590361446, 157.34790830658108, 329.3617771084337, 156.3482293338684,
        329.3617771084337, 156.3482293338684, 328.3612951807229, 156.3482293338684, 327.36081325301205,
        156.3482293338684, 325.3598493975904, 156.3482293338684, 324.35936746987954, 156.3482293338684,
        323.3588855421687, 156.3482293338684, 322.35840361445787, 156.3482293338684, 321.35792168674703,
        156.3482293338684, 319.3569578313253, 156.3482293338684, 318.35647590361447, 156.3482293338684,
        316.3555120481928, 156.3482293338684, 315.35503012048196, 156.3482293338684, 312.3535843373494,
        156.3482293338684, 310.3526204819277, 155.34855036115573, 308.35165662650604, 155.34855036115573,
        306.35069277108437, 155.34855036115573, 304.3497289156627, 155.34855036115573, 302.34876506024096,
        155.34855036115573, 300.3478012048193, 155.34855036115573, 298.3468373493976, 155.34855036115573,
        296.34587349397594, 155.34855036115573, 295.34539156626505, 155.34855036115573, 294.3449096385542,
        155.34855036115573, 292.34394578313254, 154.34887138844306, 290.34298192771087, 154.34887138844306,
        288.3420180722892, 154.34887138844306, 285.3405722891566, 154.34887138844306, 283.33960843373495,
        154.34887138844306, 281.3386445783133, 153.34919241573036, 279.3376807228916, 153.34919241573036,
        276.33623493975904, 153.34919241573036, 274.33527108433736, 153.34919241573036, 272.3343072289157,
        152.34951344301768, 270.333343373494, 152.34951344301768, 269.3328614457831, 152.34951344301768,
        268.3323795180723, 152.34951344301768, 266.3314156626506, 151.349834470305, 265.3309337349398, 151.349834470305,
        264.33045180722894, 151.349834470305, 262.32948795180727, 151.349834470305, 262.32948795180727,
        150.3501554975923, 261.32900602409643, 150.3501554975923, 260.32852409638554, 150.3501554975923,
        259.3280421686747, 150.3501554975923, 258.32756024096386, 149.35047652487964, 257.327078313253,
        149.35047652487964, 256.3265963855422, 148.35079755216697, 255.32611445783135, 148.35079755216697,
        255.32611445783135, 148.35079755216697, 254.3256325301205, 147.3511185794543, 254.3256325301205,
        147.3511185794543, 253.32515060240965, 147.3511185794543, 252.3246686746988, 146.3514396067416,
        252.3246686746988, 146.3514396067416, 252.3246686746988, 146.3514396067416, 252.3246686746988,
        146.3514396067416, 252.3246686746988, 146.3514396067416, 251.32418674698798, 146.3514396067416,
        251.32418674698798, 146.3514396067416, 251.32418674698798, 146.3514396067416, 251.32418674698798,
        146.3514396067416, 251.32418674698798, 145.35176063402892, 250.3237048192771, 145.35176063402892,
        250.3237048192771, 145.35176063402892, 249.32322289156627, 145.35176063402892, 249.32322289156627,
        144.35208166131625, 248.32274096385544, 144.35208166131625, 248.32274096385544, 144.35208166131625,
        247.3222590361446, 143.35240268860355, 247.3222590361446, 143.35240268860355, 246.32177710843374,
        143.35240268860355, 246.32177710843374, 143.35240268860355, 246.32177710843374, 142.35272371589087,
        246.32177710843374, 142.35272371589087, 246.32177710843374, 142.35272371589087, 246.32177710843374,
        142.35272371589087, 246.32177710843374, 142.35272371589087, 246.32177710843374, 142.35272371589087,
        246.32177710843374, 142.35272371589087, 246.32177710843374, 142.35272371589087, 246.32177710843374,
        142.35272371589087
      ],
      stroke: '#d8352a'
    }
  ]

  // Calculate the scaling factors
  const scaleX = width / originalSize.width
  const scaleY = height / originalSize.height

  const handlePointerDown = (e: KonvaEventObject<MouseEvent | TouchEvent>) => {
    setIsDrawing(true)
    const stage = e.target.getStage()

    if (!stage) return

    const point = stage.getPointerPosition()

    // Adjust point to original coordinates
    const adjustedPoint = {
      x: point!.x / scaleX,
      y: point!.y / scaleY
    }

    // Start a new line with stroke 'red'
    setLines([...lines, { points: [adjustedPoint.x, adjustedPoint.y], stroke: '#d8352a' }])
  }

  const handlePointerMove = (e: KonvaEventObject<MouseEvent | TouchEvent>) => {
    e.evt.preventDefault()
    if (!isDrawing) return

    const stage = e.target.getStage()

    if (!stage) return

    const point = stage.getPointerPosition()

    // Adjust point to original coordinates
    const adjustedPoint = {
      x: point!.x / scaleX,
      y: point!.y / scaleY
    }

    // Update the last line's points
    setLines((prevLines) => {
      const updatedLines = prevLines.slice()
      const lastLine = { ...updatedLines[updatedLines.length - 1] }
      lastLine.points = lastLine.points.concat([adjustedPoint.x, adjustedPoint.y])
      updatedLines[updatedLines.length - 1] = lastLine
      return updatedLines
    })
  }

  const handlePointerUp = () => {
    if (!isDrawing) return
    setIsDrawing(false)

    // Change the last line's stroke to 'green'
    setLines((prevLines) => {
      const updatedLines = prevLines.slice()
      const lastLine = { ...updatedLines[updatedLines.length - 1] }
      if (lastLine) {
        lastLine.stroke = '#feaa01'
        updatedLines[updatedLines.length - 1] = lastLine
      }
      return updatedLines
    })

    // console.log(lines)
  }

  const handleClearLines = () => {
    setLines([])
    setReveal((prev) => ({ ...prev, quiz1: false }))
  }

  return (
    <div className='font-base'>
      <div
        ref={parentRef}
        className='canvas-container relative mx-auto aspect-[4/3] w-canvas-width max-w-full overflow-hidden rounded-md bg-[url(https://images.theconversation.com/files/634718/original/file-20241127-15-5rghif.jpg?ixlib=rb-4.1.0&q=45&auto=format&w=800)] bg-cover bg-no-repeat shadow-lg'
      >
        <Stage
          width={width}
          height={height}
          scaleX={scaleX}
          scaleY={scaleY}
          onMouseDown={handlePointerDown}
          onTouchStart={handlePointerDown}
          onMouseMove={handlePointerMove}
          onTouchMove={handlePointerMove}
          onMouseUp={handlePointerUp}
          onTouchEnd={handlePointerUp}
          onMouseLeave={handlePointerUp}
          onTouchCancel={handlePointerUp}
        >
          <Layer>
            {lines.map((line, i) => (
              <Line
                key={i}
                points={line.points}
                stroke={revealAnswer.quiz1 ? '#b1b1b9' : line.stroke}
                strokeWidth={4}
                tension={0.4}
                lineCap='round'
                lineJoin='round'
              />
            ))}
            {revealAnswer.quiz1 &&
              answerLines.map((line, i) => (
                <Line
                  key={i}
                  points={line.points}
                  stroke={'#40bf95'}
                  strokeWidth={4}
                  tension={0.4}
                  lineCap='round'
                  lineJoin='round'
                />
              ))}
          </Layer>
        </Stage>

        <div className='absolute left-2 top-2 flex gap-4 text-sm md:text-lg'>
          <button
            onClick={handleClearLines}
            className='cursor-pointer bg-neutral-500/20 p-2 text-white backdrop-blur-sm transition-all duration-150 ease-in-out hover:text-neutral-100 hover:shadow-lg active:scale-95'
          >
            Clear
          </button>
          <button
            onClick={() => setReveal((prev) => ({ ...prev, quiz1: true }))}
            className='cursor-pointer bg-neutral-500/20 p-2 text-white backdrop-blur-sm transition-all duration-150 ease-in-out hover:text-neutral-100 hover:shadow-lg active:scale-95'
          >
            Reveal
          </button>
        </div>
      </div>
    </div>
  )
}
